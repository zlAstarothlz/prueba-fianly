<!--  Barra superior -->
<mat-toolbar color="primary">
  <ng-container *ngIf="user as u">
    <button mat-icon-button [matMenuTriggerFor]="userMenu" aria-label="Usuario">
      <mat-icon>account_circle</mat-icon>
    </button>
    <span style="margin-left: 8px">{{ u.name }}</span>
  </ng-container>
  <span class="toolbar-title">Tienda Virtual</span>
  <span class="spacer"></span>
</mat-toolbar>

<!-- Dashboard de usuario -->
<mat-menu #userMenu="matMenu">
  <div style="padding: 1rem; max-width: 300px">
    <h3>游녻 Informaci칩n del usuario</h3>
    <p><strong>Nombre:</strong> {{ user?.name }}</p>
    <p><strong>Email:</strong> {{ user?.email }}</p>
    <p><strong>Fecha de nacimiento:</strong> {{ user?.dateBirth }}</p>
    <p><strong>G칠nero:</strong> {{ user?.gender }}</p>
    <p>
      <strong>Intereses:</strong>
      <span *ngFor="let interest of user?.interests; let last = last">
        {{ interest.text }}<span *ngIf="!last">, </span>
      </span>
    </p>
    <p><strong>Pa칤s:</strong> {{ user?.country }}</p>
    <button
      mat-raised-button
      color="warn"
      (click)="logout()"
      style="margin-top: 1rem"
    >
      Cerrar sesi칩n
    </button>
  </div>
</mat-menu>

<!-- Filtros de b칰squeda -->
<div class="filtro">
  <mat-form-field appearance="outline" class="filtro-input">
    <mat-label>Buscar producto</mat-label>
    <input
      matInput
      [(ngModel)]="searchProduct"
      placeholder="Nombre del producto"
    />
  </mat-form-field>

  <mat-form-field appearance="outline" class="filtro-input">
    <mat-label>Precio m칤nimo</mat-label>
    <input matInput type="number" [(ngModel)]="minPrice" placeholder="0" />
    <mat-hint *ngIf="minPrice"
      >Ingresado:
      {{ minPrice | currency : "COP" : "symbol" : "1.0-0" }}</mat-hint
    >
  </mat-form-field>

  <mat-form-field appearance="outline" class="filtro-input">
    <mat-label>Precio m치ximo</mat-label>
    <input matInput type="number" [(ngModel)]="maxPrice" placeholder="10000000" />
    <mat-hint *ngIf="maxPrice"
      >Ingresado:
      {{ maxPrice | currency : "COP" : "symbol" : "1.0-0" }}</mat-hint
    >
  </mat-form-field>
</div>

<!-- Cat치logo de productos -->
<div class="productos-grid">
  <ng-container *ngIf="products.length !== 0">
    <ng-container
      *ngFor="
        let product of paginatedProducts
          | filter : searchProduct : minPrice : maxPrice
          | orderBy : 'asc'
      "
    >
      <app-product [product]="product"></app-product>
    </ng-container>
  </ng-container>
</div>

<!-- Paginaci칩n -->
<div class="pagination-controls">
  <button (click)="prevPage()" [disabled]="currentPage === 1">Anterior</button>
  <span>P치gina {{ currentPage }} de {{ totalPages() }}</span>
  <button (click)="nextPage()" [disabled]="currentPage === totalPages()">
    Siguiente
  </button>
</div>
